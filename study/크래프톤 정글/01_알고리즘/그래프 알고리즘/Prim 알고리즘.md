---
date: 2025-09-19
category: 알고리즘
week: 38
tags: [Algorithm, CLRS, 그래프이론, 그리디, 최소스패닝트리, 프림]
---
1
# 🌳 Prim 알고리즘 총정리

## 1) 정의

- **Prim 알고리즘**은 **연결된 무방향 가중치 그래프**에서 **최소 신장 트리(MST)**를 구하는 대표적인 탐욕적(greedy) 알고리즘.
    
- 그래프가 연결이 아니면 각 컴포넌트마다 **최소 신장 포레스트**가 나온다.
    

---

## 2) 핵심 아이디어 (탐욕 원리)

- 하나의 트리를 점점 키워나가면서 MST를 만든다.
    
- 현재 집합 $S$와 바깥 $V \setminus S$를 잇는 간선들 중 **가장 가벼운 간선(light edge)**을 고르고, 해당 정점을 $S$에 추가한다.
    
- 이 선택이 항상 안전한 이유 = **[[절단 속성]]**
    
    - 절단 속성: 절단을 가로지르는 가장 가벼운 간선은 반드시 MST에 포함된다.
        

---

## 3) 루프 불변식 (정확성 근거)

반복문의 시작마다:

1. 지금까지 선택된 간선 집합은 **어떤 MST의 부분집합**이다.
    
2. $S$와 바깥을 잇는 최소 간선은 항상 MST에 포함된다.
    
3. 이 간선을 추가해도 여전히 MST 부분집합 조건이 유지된다.
    

👉 모든 정점이 $S$에 들어가면 결과는 MST다.  
👉 시작 정점이 달라도 항상 MST가 나오는 이유가 여기 있다. (MST 모양은 달라질 수 있지만, 가중치 합은 동일)

---

## 4) 알고리즘 절차 (고수준)

1. 임의의 시작 정점 $s$를 선택해 $S$에 넣음
    
2. 각 정점 $v$에 대해 `key[v] = S와 v를 잇는 최소 간선 가중치`
    
3. 아직 $S$에 없는 정점 중 **key가 최소인 정점 $u$**를 뽑아 $S$에 추가
    
4. $u$의 이웃 정점 $v$에 대해, 더 싸게 연결할 수 있으면 `key[v]`와 `parent[v]` 갱신
    
5. 모든 정점이 $S$에 포함될 때까지 3–4 반복
    

👉 최종적으로 `parent[]` 배열이 MST 간선 집합을 나타낸다.

---

## 5) 자료구조 & 시간 복잡도

- **인접 리스트 + 우선순위 큐(힙)**
    
    - 최소 `key[v]` 정점 뽑기 (extract-min)
        
    - 더 싼 간선 발견 시 `decrease-key`
        
- 시간 복잡도:
    
    - 이진 힙: $O(E \log V)$
        
    - 배열(단순 구현): $O(V^2)$ → dense 그래프에서 괜찮음
        
    - 피보나치 힙: $O(E + V \log V)$ (이론적으로 가장 빠름)
        

---

## 6) Kruskal과 비교

|구분|**Prim**|**Kruskal**|
|---|---|---|
|관점|**정점 중심** (트리 하나 확장)|**간선 중심** (여러 조각 합침)|
|선택 방식|$S \leftrightarrow V\setminus S$ 절단 최소 간선|정렬된 간선 중 사이클 없으면 채택|
|사이클 처리|구조적으로 불가능|Union-Find로 검사|
|자료구조|Min-Heap (decrease-key)|Union-Find + 간선 정렬|
|권장 그래프|**Dense**|**Sparse**|

---

## 7) 자주 묻는 것들

- **음수 가중치도 되나요?**  
    → 된다. 비교는 크기만 하면 되니까.
    
- **그래프가 연결 안 돼 있으면?**  
    → 각 컴포넌트마다 MST를 찾아 **포레스트**가 된다.
    
- **왜 BFS처럼 $O(V+E)$가 아니에요?**  
    → BFS는 단순 방문만 하지만, Prim은 매번 “가장 싼 후보 간선”을 찾아야 해서 로그가 붙는다.
    

---

## 8) 직관적 비유

- $S$ = 전기 들어온 마을
    
- $V\setminus S$ = 전기 안 들어온 마을
    
- 매번 “지금 가장 싼 비용으로 전기 끌어올 수 있는 마을 하나”를 선택해 연결
    
- 반복하다 보면 전체 전선 비용이 최소가 된다
    

---

## ✅ 최종 요약

- Prim은 **트리 하나를 자라나게** 하면서, 매번 절단 속성에 의해 보장된 **가장 가벼운 간선**을 고른다.
    
- 시작 정점은 결과 모양에만 영향을 줄 뿐, 항상 **MST**를 보장한다.
    
- **Dense 그래프**에 적합하며, Kruskal과는 **관점과 구현 방식**이 다르다.