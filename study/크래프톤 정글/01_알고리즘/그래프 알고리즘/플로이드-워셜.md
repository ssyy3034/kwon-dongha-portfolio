---
date: 2025-09-19
category: 알고리즘
week: 38
tags: [Algorithm, CLRS, 그래프이론, 그리디, 플로이드워셜]
---

# 🌍 플로이드–워셜 알고리즘 (Floyd–Warshall)

## 1) 문제 정의

- **모든 쌍 최단 경로 (APSP, All-Pairs Shortest Path)** 문제 해결
    
- **입력**: 가중치가 있는 그래프 (음수 간선 허용)
    
- **출력**: 모든 정점 쌍 $(i,j)$에 대한 최단 거리 행렬 $D[i][j]$
    
- **제약**: 그래프에 **음수 사이클**이 있으면 최단 경로가 정의되지 않음
    

---

## 2) 핵심 아이디어 (동적 프로그래밍)

- **경유지를 하나씩 늘려가며 최단 경로를 점진적으로 갱신**
---

## 3) 알고리즘 절차 (의사코드)

```text
FLOYD-WARSHALL(W):
  D = W   // 인접 행렬, 자기 자신=0, 간선 없으면 ∞
  for k = 1 to n:
    for i = 1 to n:
      for j = 1 to n:
        if D[i][j] > D[i][k] + D[k][j]:
          D[i][j] = D[i][k] + D[k][j]
  return D
```

---

## 4) 동작 예시 (정점 4개)

그래프:

- 1→2=5, 1→4=10, 2→3=3, 3→4=1
    

업데이트 흐름:

- **k=0 (직항만)**: $D[1][3] = ∞$
    
- **k=2**: $D[1][3] = 8$ (1→2→3)
    
- **k=3**: $D[1][4] = 9$ (1→2→3→4), $D[2][4] = 4$ (2→3→4)
    
- 최종 $D$ 행렬이 모든 쌍 최단 거리
    

---

## 5) 시간·공간 복잡도

- 시간: $O(V^3)$
    
- 공간: $O(V^2)$
    
- **작은 그래프(수백 정점 이하)** 에서만 실용적
    

---

## 6) 장단점

✅ **장점**

- 모든 쌍 최단 경로 한 번에 구함
    
- 음수 간선 허용
    
- 구현이 단순, 직관적
    

❌ **단점**

- $O(V^3)$ → 정점이 많으면 비현실적
    
- 음수 사이클 존재 시 결과 무의미
    

---

## 7) 활용 사례

- 도시 간 **모든 쌍 최단 거리** 계산 (교통, 물류)
    
- **경유 조건**이 포함된 경로 최적화
    
- **쿼리 많은 경우** (한 번 돌려서 행렬을 저장 → 빠른 질의 응답 가능)
    

---

## 8) 다익스트라와 비교

|알고리즘|문제 유형|시간 복잡도|음수 가중치|결과|
|---|---|---|---|---|
|다익스트라|단일 출발점 최단 경로 (SSSP)|$O(E \log V)$|❌|시작점 기준 SPT|
|플로이드–워셜|모든 쌍 최단 경로 (APSP)|$O(V^3)$|✅ (사이클 ❌)|최단 거리 행렬 $D$|

---

## ✅ 최종 요약

플로이드–워셜은 **“모든 정점 쌍의 최단 경로를 DP로 구하는 $O(V^3)$ 알고리즘”** 이다.  
핵심은 **경유지를 하나씩 늘려가며 더 짧은 길이 있으면 갱신하는 것**이며,  
작은 그래프에서는 단순하면서도 강력한 해법이다.
