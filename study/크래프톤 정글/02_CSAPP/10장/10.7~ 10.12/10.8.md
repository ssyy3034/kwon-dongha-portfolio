---
date: 2025-10-30
tags: [CS]
---

## ## 10.8 파일 공유

유닉스 시스템에서 파일은 여러 프로세스나 디스크립터에 의해 다양한 방식으로 공유될 수 있습니다. 이 공유 메커니즘을 이해하려면 커널이 열린 파일을 어떻게 표현하는지 알아야 합니다.

### ### [[커널의 파일 공유 구조]]

커널은 열린 파일을 관리하기 위해 **세 가지 연관된 자료 구조**를 사용합니다. 이 구조들의 상호작용을 통해 파일 공유가 이루어집니다.

1. **디스크립터 테이블 (Descriptor Table):**
    
    - **프로세스별로 독립적**으로 존재합니다.
        
    - 프로세스가 사용하는 파일 디스크립터를 인덱스로 사용하며, 각 항목은 파일 테이블의 특정 항목을 가리킵니다.
        
2. **파일 테이블 (Open File Table):**
    
    - **모든 프로세스가 공유**하는 단일 테이블입니다.
        
    - 각 항목은 **현재 파일 위치(file position)**, **참조 카운트(reference count)**, v-node 테이블 항목 포인터를 포함합니다.
        
    - 참조 카운트는 이 항목을 가리키는 디스크립터 테이블 항목의 개수를 나타냅니다.
        
3. **v-node 테이블 (v-node Table):**
    
    - 이 테이블 역시 **모든 프로세스가 공유**합니다.
        
    - 파일 크기(`st_size`), 파일 종류(`st_mode`) 등 `stat` 구조체에 있는 대부분의 **파일 메타데이터 정보**를 담고 있습니다.